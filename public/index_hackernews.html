<!--Documents/working/2015/programming/visa_app.html -->

<!DOCTYPE html>
<html>
<head>
  <script src="https://code.jquery.com/jquery-2.1.4.min.js"></<script>

  </script>
</head>
<body>

  <script>
    var numArrayItems = 5;

    //$.ready(


      var jhxr =  $.ajax({
          method: 'GET',
          // headers: {
          //   origin: 'http://www.carolchung.com'
          // },
          //works
          url: 'https://hacker-news.firebaseio.com/v0/topstories.json?print=pretty'//,
          //url: 'https://hacker-news.firebaseio.com/v0/newstories.json?print=pretty'
          //doesn't work SOP
          //url: 'http://www.npr.org/rss/rss.php?id=1001'
          //url: 'http://feeds.bbci.co.uk/news/rss.xml?edition=us',
        }).
        done(function(data) {
          console.log('data: ' + data);
          var topStoriesAr = data.slice(0, numArrayItems);
          console.log(topStoriesAr.length);
          console.log('topStoriesAr: ' + topStoriesAr);

          topStoriesAr.forEach(function(story) {
            var jhxrInner = $.ajax({
              url: 'https://hacker-news.firebaseio.com/v0/item/' + story + '.json?print=pretty'
            }).
            done(function(data) {
              //console.log('inner data: ' + data);
              var itemObj = data;
              console.log('itemObj.title: ' + itemObj.title);
              console.log('itemObj.url: ' + itemObj.url);

            }).
            fail(function(err, str) {
              console.log('error: ' + str);
            }).
            always(function() {
              console.log('inner got here ');
            });

          });


        }).
        fail(function(err) {
          console.log('error: ' + err.type);
        }).
        always(function() {
          console.log('got here');
        });
    //);
  </script>
</body>
</html>
